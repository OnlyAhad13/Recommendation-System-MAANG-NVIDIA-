2025-10-07 19:13:50,776 - INFO - ================================================================================
2025-10-07 19:13:50,776 - INFO - STARTING TRAINING
2025-10-07 19:13:50,777 - INFO - ================================================================================
2025-10-07 19:13:50,778 - INFO - Loading data from ../movies_dataset/processed_data.pkl
2025-10-07 19:13:50,865 - INFO - Preparing datasets...
2025-10-07 19:13:50,865 - INFO - Engineering features for train - Shape: (800167, 15)
2025-10-07 19:13:53,888 - INFO - Engineering features for val - Shape: (100020, 15)
[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
2025-10-07 19:13:54,969 - INFO - Training for 5 epochs...
Epoch 1/5
/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/layers/layer.py:396: UserWarning: `build()` was called on layer 'multi_tower_model', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/layers/layer.py:396: UserWarning: `build()` was called on layer 'multi_task_model', however the layer does not have a `build()` method implemented and it looks like it has unbuilt state. This will cause the layer to be marked as built, despite not being actually built, which may cause failures down the line. Make sure to implement a proper `build()` method.
  warnings.warn(
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 565ms/step - binary_accuracy: 0.5433 - loss: 823450.7500 - regularization_loss: 0.0058 - root_mean_squared_error: 1490.1328 - total_loss: 823450.7500
Epoch 1: val_loss improved from inf to 12784.27637, saving model to recsys_output/best_model.keras
2025-10-07 19:15:57,252 - INFO - Epoch 1: 122.2s | Loss: 14054.5342 | Mem: 1619MB
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m122s[0m 591ms/step - binary_accuracy: 0.5433 - loss: 819342.1875 - regularization_loss: 0.0058 - root_mean_squared_error: 1487.9025 - total_loss: 819342.1875 - val_binary_accuracy: 0.5777 - val_loss: 12784.2764 - val_regularization_loss: 0.0063 - val_root_mean_squared_error: 2.1871 - val_total_loss: 12784.2822
Epoch 2/5
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 465ms/step - binary_accuracy: 0.5447 - loss: 48637.8789 - regularization_loss: 0.0065 - root_mean_squared_error: 40.4581 - total_loss: 48637.8867
Epoch 2: val_loss did not improve from 12784.27637
2025-10-07 19:17:33,685 - INFO - Epoch 2: 96.3s | Loss: 14081.9775 | Mem: 1649MB
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m96s[0m 492ms/step - binary_accuracy: 0.5448 - loss: 48462.4688 - regularization_loss: 0.0065 - root_mean_squared_error: 40.4174 - total_loss: 48462.4766 - val_binary_accuracy: 0.5756 - val_loss: 12787.6104 - val_regularization_loss: 0.0065 - val_root_mean_squared_error: 1.8219 - val_total_loss: 12787.6172
Epoch 3/5
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 417ms/step - binary_accuracy: 0.5577 - loss: 46290.0117 - regularization_loss: 0.0066 - root_mean_squared_error: 25.2110 - total_loss: 46290.0195
Epoch 3: val_loss did not improve from 12784.27637
2025-10-07 19:19:00,039 - INFO - Epoch 3: 86.2s | Loss: 12997.2900 | Mem: 1650MB
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m86s[0m 440ms/step - binary_accuracy: 0.5577 - loss: 46121.0117 - regularization_loss: 0.0066 - root_mean_squared_error: 25.1862 - total_loss: 46121.0195 - val_binary_accuracy: 0.5762 - val_loss: 12824.4365 - val_regularization_loss: 0.0067 - val_root_mean_squared_error: 1.6481 - val_total_loss: 12824.4434
Epoch 4/5
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 434ms/step - binary_accuracy: 0.5638 - loss: 45106.0742 - regularization_loss: 0.0067 - root_mean_squared_error: 22.0921 - total_loss: 45106.0820
Epoch 4: val_loss did not improve from 12784.27637
2025-10-07 19:20:29,680 - INFO - Epoch 4: 89.5s | Loss: 13495.6396 | Mem: 1651MB
[1m196/196[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m90s[0m 457ms/step - binary_accuracy: 0.5637 - loss: 44945.6172 - regularization_loss: 0.0067 - root_mean_squared_error: 22.0742 - total_loss: 44945.6250 - val_binary_accuracy: 0.5721 - val_loss: 12930.7061 - val_regularization_loss: 0.0068 - val_root_mean_squared_error: 1.6901 - val_total_loss: 12930.7129
Epoch 4: early stopping
Restoring model weights from the end of the best epoch: 1.
2025-10-07 19:20:29,721 - INFO - Evaluating model...
2025-10-07 19:20:30,040 - INFO - Evaluation Results:
2025-10-07 19:20:30,040 - INFO -   recall@10: 0.0070
2025-10-07 19:20:30,040 - INFO -   recall@20: 0.0130
2025-10-07 19:20:30,040 - INFO -   recall@5: 0.0040
2025-10-07 19:20:30,040 - INFO -   recall@50: 0.0400
2025-10-07 19:20:30,042 - INFO - Saving artifacts...
2025-10-07 19:20:30,119 - INFO - Building FAISS index...
2025-10-07 19:20:30,252 - INFO - FAISS index built: 3662 items, type=IndexFlatIP
2025-10-07 19:20:30,257 - INFO - ================================================================================
2025-10-07 19:20:30,257 - INFO - TRAINING COMPLETE
2025-10-07 19:20:30,257 - INFO - ================================================================================
2025-10-07 19:20:30,297 - INFO - SUCCESS! Artifacts saved to: ./recsys_output
