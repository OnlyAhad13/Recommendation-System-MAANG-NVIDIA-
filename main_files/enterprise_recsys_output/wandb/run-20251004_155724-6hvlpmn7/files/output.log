2025-10-04 15:57:25,815 - INFO - Starting enterprise-grade training pipeline...
2025-10-04 15:57:25,815 - INFO - Loading data from ../movies_dataset/processed_data.pkl
2025-10-04 15:57:25,885 - INFO - Preparing datasets...
2025-10-04 15:57:25,885 - INFO - Engineering features for train data
2025-10-04 15:57:27,964 - INFO - Engineering features for val data
2025-10-04 15:57:28,185 - INFO - Engineering features for test data
2025-10-04 15:57:28,409 - INFO - Fitting negative sampler...
[34m[1mwandb[0m: [33mWARNING[0m WandbCallback is deprecated and will be removed in a future release. Please use the WandbMetricsLogger, WandbModelCheckpoint, and WandbEvalCallback callbacks instead. See https://docs.wandb.ai/guides/integrations/keras for more information.
2025-10-04 15:57:31,700 - INFO - Starting model training...
2025-10-04 15:57:33,155 - ERROR - Training failed: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling MultiTowerModel.call().

[1mCan not squeeze dim[1], expected a dimension of 1, got 128 for '{{node multi_task_model_1/multi_tower_model_1/Squeeze}} = Squeeze[T=DT_HALF, squeeze_dims=[1]](multi_task_model_1/multi_tower_model_1/embedding_1/Cast_1)' with input shapes: [8192,128].[0m

Arguments received by MultiTowerModel.call():
  â€¢ features={'user_id': 'tf.Tensor(shape=(8192,), dtype=string)', 'movie_id': 'tf.Tensor(shape=(8192,), dtype=string)', 'rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'y_implicit': 'tf.Tensor(shape=(8192,), dtype=float16)', 'timestamp': 'tf.Tensor(shape=(8192,), dtype=float16)', 'datetime': 'tf.Tensor(shape=(8192,), dtype=string)', 'rating_year': 'tf.Tensor(shape=(8192,), dtype=float16)', 'year': 'tf.Tensor(shape=(8192,), dtype=float16)', 'age_at_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_avg_rating_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_count_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_std_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_avg_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_rating_count': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_rating_std': 'tf.Tensor(shape=(8192,), dtype=float16)', 'hour': 'tf.Tensor(shape=(8192,), dtype=float16)', 'day_of_week': 'tf.Tensor(shape=(8192,), dtype=float16)', 'is_weekend': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_count_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_avg_rating_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_std_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_unique_items': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_rating_count': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_avg_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_rating_std': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_unique_users': 'tf.Tensor(shape=(8192,), dtype=float16)'}
  â€¢ training=False'
Traceback (most recent call last):
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 1251, in <module>
    main()
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 1239, in main
    model, history = trainer.train(args.pickle_path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 808, in train
    history = model.fit(
              ^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/trainers/trainer.py", line 1091, in _symbolic_build
    raise RuntimeError(
RuntimeError: Unable to automatically build the model. Please build it yourself before calling fit/evaluate/predict. A model is 'built' when its variables have been created and its `self.built` attribute is True. Usually, calling the model on a batch of data is the right way to build it.
Exception encountered:
'Exception encountered when calling MultiTowerModel.call().

[1mCan not squeeze dim[1], expected a dimension of 1, got 128 for '{{node multi_task_model_1/multi_tower_model_1/Squeeze}} = Squeeze[T=DT_HALF, squeeze_dims=[1]](multi_task_model_1/multi_tower_model_1/embedding_1/Cast_1)' with input shapes: [8192,128].[0m

Arguments received by MultiTowerModel.call():
  â€¢ features={'user_id': 'tf.Tensor(shape=(8192,), dtype=string)', 'movie_id': 'tf.Tensor(shape=(8192,), dtype=string)', 'rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'y_implicit': 'tf.Tensor(shape=(8192,), dtype=float16)', 'timestamp': 'tf.Tensor(shape=(8192,), dtype=float16)', 'datetime': 'tf.Tensor(shape=(8192,), dtype=string)', 'rating_year': 'tf.Tensor(shape=(8192,), dtype=float16)', 'year': 'tf.Tensor(shape=(8192,), dtype=float16)', 'age_at_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_avg_rating_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_count_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_std_x': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_avg_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_rating_count': 'tf.Tensor(shape=(8192,), dtype=float16)', 'movie_rating_std': 'tf.Tensor(shape=(8192,), dtype=float16)', 'hour': 'tf.Tensor(shape=(8192,), dtype=float16)', 'day_of_week': 'tf.Tensor(shape=(8192,), dtype=float16)', 'is_weekend': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_count_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_avg_rating_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_rating_std_y': 'tf.Tensor(shape=(8192,), dtype=float16)', 'user_unique_items': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_rating_count': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_avg_rating': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_rating_std': 'tf.Tensor(shape=(8192,), dtype=float16)', 'item_unique_users': 'tf.Tensor(shape=(8192,), dtype=float16)'}
  â€¢ training=False'
