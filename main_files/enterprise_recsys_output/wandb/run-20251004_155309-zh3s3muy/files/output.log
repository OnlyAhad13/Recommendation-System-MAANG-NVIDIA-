2025-10-04 15:53:11,125 - INFO - Starting enterprise-grade training pipeline...
2025-10-04 15:53:11,125 - INFO - Loading data from ../movies_dataset/processed_data.pkl
2025-10-04 15:53:11,194 - INFO - Preparing datasets...
2025-10-04 15:53:11,195 - INFO - Engineering features for train data
2025-10-04 15:53:13,186 - INFO - Engineering features for val data
2025-10-04 15:53:13,406 - INFO - Engineering features for test data
2025-10-04 15:53:13,626 - INFO - Fitting negative sampler...
2025-10-04 15:53:16,856 - ERROR - Training failed: Cannot convert '('c', 'o', 'u', 'n', 't', 'e', 'r')' to a shape. Found invalid entry 'c' of type '<class 'str'>'.
Traceback (most recent call last):
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 1254, in <module>
    main()
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 1242, in main
    model, history = trainer.train(args.pickle_path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 788, in train
    model = MultiTaskModel(
            ^^^^^^^^^^^^^^^
  File "/home/onlyahad/Desktop/Recommendation System/main_files/recommendation_system.py", line 547, in __init__
    factorized_topk = tfrs.metrics.FactorizedTopK(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/tensorflow_recommenders/metrics/factorized_top_k.py", line 79, in __init__
    layers.factorized_top_k.Streaming(k=max(ks))
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/tensorflow_recommenders/layers/factorized_top_k.py", line 376, in __init__
    self._counter = self.add_weight("counter", dtype=tf.int32, trainable=False)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/layers/layer.py", line 547, in add_weight
    variable = backend.Variable(
               ^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/backend/common/variables.py", line 185, in __init__
    self._shape = self._validate_shape(shape)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/backend/common/variables.py", line 207, in _validate_shape
    shape = standardize_shape(shape)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/onlyahad/miniconda3/envs/ml_global/lib/python3.11/site-packages/keras/src/backend/common/variables.py", line 582, in standardize_shape
    raise ValueError(
ValueError: Cannot convert '('c', 'o', 'u', 'n', 't', 'e', 'r')' to a shape. Found invalid entry 'c' of type '<class 'str'>'.
